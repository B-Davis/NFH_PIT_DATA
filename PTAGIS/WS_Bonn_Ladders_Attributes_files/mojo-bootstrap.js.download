var xmjd=mstrmojo&&mstrmojo.descriptors;var mstrmojo={helpPath:function(){return(mstrApp.helpUrl||"../help/")+"MSTRWeb/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/Content/";},helpPathMobileAdmin:function(){return(mstrApp.helpUrl||"../help/")+"MobileAdmin/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/";},upgradeHelpPath:function(){return(mstrApp.upgradeHelpUrl||"../help/")+"WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/Content/";},descriptors:xmjd||{},meta:{TP:"t",STP:"st"},emptyFn:function(){},tstid:function(B){var A;if(B){if(typeof (B)==="object"){A=B.tstid;}else{A=B;}}return A?'tstid="'+A+'"':"";},getMissingFn:function getMissingFn(){return function(){var C=this.scriptClass,A;try{for(A in this){if(this[A]===arguments.callee){C+="."+A;break;}}}catch(B){}throw new Error("Missing abstract method: "+C);};},now:function now(){return new Date().getTime();},usesFrames:false,getObj:function getObj(A){if(!A||A.destroyed){return null;}return A;},inClosureProps:{inClosure:true}};(function(){mstrmojo.global=(function(){var F=function(){return this;};return F.call(null);}());mstrmojo.dbg=mstrmojo.emptyFn;mstrmojo.dbg_stack=mstrmojo.emptyFn;mstrmojo.dbg_xhr=mstrmojo.emptyFn;mstrmojo.dbg_profile=mstrmojo.emptyFn;mstrmojo.debugBundles=(function(){return(window.mstrConfig&&(mstrConfig.debugFlags!==undefined)&&((mstrConfig.debugFlags&4)>0));})();mstrmojo.platform={};mstrmojo.prompt={};mstrmojo.settings={};mstrmojo.models={datasets:{},template:{}};mstrmojo.ui={editors:{controls:{}},menus:{},pathbar:{}};mstrmojo.prefs={};mstrmojo.ACL={};mstrmojo.CMS={};mstrmojo.storage={};mstrmojo.maps={};mstrmojo.maps.androidmap={};mstrmojo.maps.jsmap={};mstrmojo.graph={};mstrmojo.sm={};mstrmojo.sort={};mstrmojo.customviz={};mstrmojo.ME={};mstrmojo.architect={ui:{editors:{},panels:{},factories:{}},obj:{},menu:{},projectmanagement:{}};mstrmojo.warehouse={ui:{editors:{}},obj:{},dbroles:{},menu:{}};mstrmojo.plugins={};mstrmojo.AS={};mstrmojo.DI={controller:{},model:{},ui:{dialogs:{}}};mstrmojo.Refine={};mstrmojo.qb={bigquery:{},es:{},mdx:{},menu:{},thirdParty:{},s4hana:{},cc:{},};mstrmojo.WH={};mstrmojo.fe={};mstrmojo.txEditor={};mstrmojo.condTx={};mstrmojo.threshold={};mstrmojo.express={ui:{}};mstrmojo.rw={model:{},xtab:{}};mstrmojo.util={ui:{}};mstrmojo.android={controllers:{},factories:{},inputControls:{},large:{controllers:{},factories:{},ui:{}},medium:{controllers:{},factories:{},ui:{nativebar:{}}},selectors:{},ui:{},nativedialog:{}};mstrmojo.mobile={vi:{ui:{rw:{xtab:{}}}},kpicard:{},mapbox:{},customviz:{},netviz:{},gm:{},ngm:{},gmaps:{layer:{mapbox:{}}},ag:{ui:{}}};mstrmojo.vi={controllers:{},factories:{},models:{editors:{},validation:{}},enums:{},ui:{menus:{},editors:{fe:{},cm:{},nlp:{}},rw:{selectors:{},xtab:{}},tabs:{},toolbars:{}},viz:{},util:{}};mstrmojo.ag={models:{editors:{},template:{}},ui:{},chart:{}};mstrmojo.onetier={controllers:{},vi:{acl:{},prefs:{model:{}},ui:{}}};mstrmojo.config={vi:{},onetier:{}};mstrmojo.chart={common:{},enums:{},model:{enums:{}}};mstrmojo.nativeandroid={};mstrmojo.gm={touch:{}};mstrmojo.ngm={};mstrmojo.heatmap={vi:{}};mstrmojo.netviz={};mstrmojo.imagelayout={};mstrmojo.kpicard={layout:{},editors:{}};mstrmojo.surveys={};mstrmojo.iphone={};mstrmojo.winphone={};mstrmojo.mstr={search:{}};mstrmojo.mstr.ui={};mstrmojo.gmaps={basemap:{},graphic:{},geometry:{},layer:{svg:{},canvas:{},mapbox:{}}};mstrmojo.esrimap={};mstrmojo.mapbox={ui:{selectors:{}}};mstrmojo.examples={};mstrmojo.home={controllers:{},models:{},views:{},ui:{}};mstrmojo.workstation={pages:{}};mstrmojo.err=function D(I,H){var G=I.name+': "'+I.message+'"';if(mstrmojo.debug){if(I.fileName){G+=" at\n    "+I.fileName;}if(I.hasOwnProperty("lineNumber")){G+=": "+I.lineNumber;}else{if(I.hasOwnProperty("line")&&I.sourceURL){var F=I.sourceURL.split("/");G+="("+F[F.length>1?F.length-1:0]+":"+I.line+")";}}}this.dbg(G);if(mstrmojo.Dialog){mstrmojo.error({longDesc:I.message,code:I.code},H,{title:I.name});}else{window.alert(G);}};mstrmojo.confirm=function B(F){return window.confirm(F);};mstrmojo.alert=function E(F){window.alert(F);};var C=!!(/return true/.test(String(function(){return true;})));mstrmojo.mixin=function A(J,H){if(J){H=H||{};var I=/this\.\_super/;var G=function(N,M){return function L(){var P=this._super;this._super=M;var O=N.apply(this,arguments||[]);this._super=P;return O;};};var F=J.__onmixin__;if(F){delete J.__onmixin__;}var K;for(K in J){if((typeof J[K]==="function")&&(!C||I.test(J[K]))){H[K]=G(J[K],H[K]);}else{H[K]=J[K];}}if(F){J.__onmixin__=F;}}return H;};}());(function(){var $XHR;var NEW_FORMAT_JS_REGEX=/\/plugins\/.+\/formatPanelBundles\/format\.js$/;var $MISSING={};var getApp=function(){return mstrmojo.global.mstrApp||{};},getJsRoot=function(){return getApp().jsRoot||"../javascript/";},getJsBundlesRoot=function(){return getJsRoot()+"bundles/";},getJsMojoRoot=function(){return getApp().jsMojoRoot||"../javascript/mojo/js/source/";},getPluginRoot=function(){return getApp().pluginRoot||"../plugins/";},getPluginMojoRoot=function(){return getApp().pluginMojoRoot||getJsMojoRoot();},isIE=!!document.all;function getXHR(){$XHR=self.XMLHttpRequest?new XMLHttpRequest():(self.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null);}function shouldSkipError4Path(filePath){if(typeof filePath!=="string"){return false;}return !!filePath.match(NEW_FORMAT_JS_REGEX);}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){if(params.hasOwnProperty(p)){url[++x]=p+"="+encodeURIComponent(params[p]);}}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function syncXHR(method,baseUrl,params){var result=null;method=method.toUpperCase();if(!$XHR){getXHR();}if($XHR){try{var m=null,app=window.mstrApp;if(window.microstrategy!==undefined&&microstrategy){m=microstrategy;}params.taskContentType=params.taskContentType||"json";params.taskEnv="xhr";params.xts=mstrmojo.now();params=mstrmojo.addCSRFTokenToTaskParams(params);var ptp=(app&&app.persistTaskParams)||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}$XHR.open(method,appendUrlParams(method,baseUrl,params),false);$XHR.setRequestHeader("X-Requested-With","XMLHttpRequest");if(method!=="POST"){params=null;}else{params=encodeParams(params);$XHR.setRequestHeader("Content-type","application/x-www-form-urlencoded");}$XHR.send(params);result=$XHR.responseText||null;}catch(localerr){if(window.console){window.console.log(localerr);}}}return result;}function _jsGet(file,nullCheck){var js=mstrmojo.loadFileSync(file);if(js){try{eval(js);return nullCheck?!!verifyJsLoaded(nullCheck):true;}catch(localerr){if(shouldSkipError4Path(file)){return false;}window.alert("JavaScript compile error:\n\nFile: "+file+"\n\nError: "+localerr.message);}}return false;}mstrmojo.requiresBundle=function reqBundle(bundleNames){var bundles=(bundleNames||"").split(",");return bundles.every(function(bundleName){bundleName=getJsBundlesRoot()+bundleName.trim();var loaded=reqCache[bundleName];if(!loaded&&_jsGet(bundleName)){reqCache[bundleName]=true;loaded=true;}return loaded;});};mstrmojo.requiresDepLib=function requiresDepLib(file,AMD){if(reqCache[file]){return true;}function isAMD(){return"function"===typeof define&&define.amd;}var AMDCache=window.define;if(!AMD&&isAMD()){delete window.define;}var value=_jsGet(file);reqCache[file]=true;window.define=AMDCache;return value;};mstrmojo.loadFileSync=function loadFileSync(file){var result=null;if(!$XHR){getXHR();}if($XHR){try{$XHR.open("GET",mstrmojo.util.version.getResourcePathWithVersion(file),false);$XHR.setRequestHeader("X-Requested-With","XMLHttpRequest");$XHR.send(null);result=$XHR.responseText||null;}catch(localerr){}if(!isIE&&$XHR.abort){$XHR.abort();}}return result;};mstrmojo.loadScript=function loadScript(file,onload,onerror){var script=document.createElement("script");script.onload=function(){if(onload){onload();}};script.onerror=function(){if(onerror){onerror("Failed to load: "+file);}};script.src=file;document.head.appendChild(script);};mstrmojo.insertCSSLinks=function insertCSSLinks(files,onLoadFn){var css,firsthead;if(files&&files.length>0){firsthead=document.getElementsByTagName("head")[0];files.forEach(function(file){css=document.createElement("link");css.setAttribute("id",file.replace(/[^a-zA-Z0-9]/g,""));css.setAttribute("rel","stylesheet");css.setAttribute("type","text/css");css.setAttribute("href",file);if(onLoadFn){css.addEventListener("load",function(){onLoadFn(file);});}firsthead.appendChild(css);});}};mstrmojo.loader={loaded:{mstrmojo:true,"mstrmojo.loader":true},isLoaded:function isLd(fqcn){var isLoaded=!!verifyJsLoaded(fqcn);if(isLoaded){this.loaded[fqcn]=true;}return isLoaded;},load:function ld(fqcn){if($MISSING[fqcn]){return false;}if(this.loaded[fqcn]||this.isLoaded(fqcn)){return true;}if(_jsGet(this.fqcnToFile(fqcn),fqcn)){this.loaded[fqcn]=true;return true;}$MISSING[fqcn]=true;return false;},fqcnToFile:function fqcnToFile(fqcn){if(fqcn.match(/^mstrmojo\.plugins\./)){var pluginName=fqcn.substring(17,fqcn.indexOf(".",17)),pluginFile=pluginName+"/javascript/"+getPluginMojoRoot()+fqcn.replace("mstrmojo.plugins."+pluginName+".","").replace(/\./gm,"/");if(mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode()&&mstrConfig.dossierServerPluginNames&&mstrConfig.dossierServerPluginNames.indexOf(pluginName)>-1){fqcn=mstrApp.dossierServerBaseUrl+"plugins/"+pluginFile;}else{fqcn=getPluginRoot()+pluginFile;}}else{if(fqcn.match(/^mstrmojo\./)){fqcn=getJsMojoRoot()+fqcn.replace("mstrmojo.","").replace(/\./gm,"/");}else{fqcn=getJsRoot()+fqcn.replace(/\./gm,"/");}}return fqcn+".js";},loadBundleWithCss:function loadBundleWithCss(jsClass,bundlePath,cssPaths,callback,onJsBundleLoaded){if(this.isLoaded(jsClass)){callback();return ;}mstrmojo.requiresBundle(bundlePath);if((typeof onJsBundleLoaded!=="undefined")&&onJsBundleLoaded){onJsBundleLoaded();}if(cssPaths&&cssPaths.length){mstrmojo.insertCSSLinks(cssPaths,callback);}else{if(callback){callback();}}}};var $LOADER=mstrmojo.loader,isLoaded=$LOADER.loaded;var reqCache={},addPackagesToReqCache=function addPkg(n,ns){var ps=n.split("."),klen=ps.length,k;for(k=1;k<klen;k++){var s=ps.slice(0,k).join(".");if(!reqCache[s]){ns.push(s);reqCache[s]=true;}}},loadInputScripts=function loadInputScripts(ns){var jlen=ns.length,j;for(j=0;j<jlen;j++){if(!$LOADER.load(ns[j])){window.alert("Warning: Javascript class not found:\n"+ns[j]);break;}}};mstrmojo.requiresCls=function reqCls(){var argLen=arguments.length,ns=[],i,len;for(i=0,len=argLen;i<len;i++){var n=arguments[i];if(!n||isLoaded[n]||$MISSING[n]){continue;}else{if(reqCache[n]){loadInputScripts([n]);reqCache[n]=false;continue;}}if(!n.match(/^mstrmojo\.plugins\./)){addPackagesToReqCache(n,ns);}ns.push(n);reqCache[n]=true;}loadInputScripts(ns);return true;};mstrmojo.requiresClsP=function reqClsP(){var argLen=arguments.length,ns=[],pkgName=arguments[0],i,len;addPackagesToReqCache(pkgName,ns);for(i=1,len=argLen;i<len;i++){var n=pkgName+"."+arguments[i];if(!n||isLoaded[n]||$MISSING[n]){continue;}else{if(reqCache[n]){loadInputScripts([n]);reqCache[n]=false;continue;}}if(!n.match(/^mstrmojo\.plugins\./)){ns.push(n);reqCache[n]=true;}}loadInputScripts(ns);return true;};var $DESCRIPTORS=mstrmojo.descriptors,descPrefix="mstrWeb.";function populateDescriptors(ds){if(ds){var dlen=ds.length,di;for(di=0;di<dlen;di++){var d=ds[di];$DESCRIPTORS[d.key]=d.v;}}}mstrmojo.populateDescriptors=populateDescriptors;if(window.mstrConfig!==undefined){populateDescriptors(mstrConfig.mstrDescs&&mstrConfig.mstrDescs.descriptors);mstrConfig.mstrDescs=null;populateDescriptors(mstrConfig.customDescs&&mstrConfig.customDescs.descriptors);mstrConfig.customDescs=null;}if(window.mstrApp!==undefined){populateDescriptors(mstrApp.mstrDescs&&mstrApp.mstrDescs.descriptors);}var requestDescriptor=function(prefix,ids){var ns=[],len=ids.length,i;for(i=0;i<len;i++){var k=ids[i];if(k&&!($DESCRIPTORS.hasOwnProperty(prefix+k))){ns.push(k);}}if(ns.length>0){var response=syncXHR("POST",(window.mstrConfig&&mstrConfig.taskURL)||"taskProc",{taskId:"getDescriptors",keys:ns.join(","),prefix:prefix});if(response){var r=JSON.parse(response.replace(/\\'/g,"'"));populateDescriptors(r&&r.descriptors);}}};mstrmojo.requiresDescsWPrefix=function reqDescP(prefix){var args=[].slice.call(arguments);args[0]=null;requestDescriptor(prefix,args);};mstrmojo.requiresDescs=function reqDesc(){if(window.mstrConfig!==undefined&&!mstrConfig.onMobileDevice){requestDescriptor(descPrefix,arguments);}};mstrmojo.desc=function desc(descID,defText){if(descID!==null&&descID!==undefined){mstrmojo.requiresDescs(descID);if($DESCRIPTORS.hasOwnProperty(descPrefix+descID)){return $DESCRIPTORS[descPrefix+descID];}defText=defText||"No string descriptor found for descID="+descID;}var decDefText="["+defText+"]";$DESCRIPTORS[descPrefix+descID]=decDefText;return decDefText;};mstrmojo.descP=function descP(prefix,descID,defText){mstrmojo.requiresDescsWPrefix(prefix,descID);if($DESCRIPTORS.hasOwnProperty(prefix+descID)){return $DESCRIPTORS[prefix+descID];}defText=defText||"No string descriptor found for descID="+descID;var decDefText="*"+defText+"*";$DESCRIPTORS[prefix+descID]=decDefText;return decDefText;};mstrmojo.provide=function prv(fqcn,cls){isLoaded[fqcn]=!!cls;return cls;};mstrmojo.invalidateCls=function rel(fqcn){reqCache[fqcn]=false;isLoaded[fqcn]=false;this.invalidateJsLoaded(fqcn);};var mx=mstrmojo.mixin;mstrmojo.declare=function declare(SuperCls,mixins,config){function Constr(props){if((!props||!props.dontInit)&&this.init){this.init(props);}}if(SuperCls){Constr.prototype=new SuperCls({dontInit:true});Constr.prototype.constructor=Constr;}var proto=Constr.prototype;var cnt=(mixins&&mixins.length)||0,i;for(i=0;i<cnt;i++){mx(mixins[i],proto);}if(config){mx(config,proto);if(config.scriptClass){isLoaded[config.scriptClass]=true;}}return Constr;};mstrmojo.findAncestor=function findAncestor(src,property,value,limitClass){var ancestor=src&&src.parent;while(ancestor&&(!limitClass||!(ancestor instanceof limitClass))){var targetProperty=ancestor[property];if(targetProperty!==undefined){if(value!==undefined&&value!==null){if(targetProperty===value){return ancestor;}}else{return ancestor;}}ancestor=ancestor.parent;}return null;};mstrmojo.isDescendant=function isDescendant(parent,child){var ancestor;if(!child||!parent){return false;}ancestor=child.parent;while(ancestor){if(ancestor===parent){return true;}ancestor=ancestor.parent;}return false;};mstrmojo.getCSRFToken=function getCSRFToken(url){var tkn=null;try{if(url){if(url.indexOf("validateRandNum=")>=0){return tkn;}if(this.isUrlExternal(url)){return tkn;}}if(window.mstrApp&&mstrApp.validateRandNum){tkn=mstrApp.validateRandNum;}else{if(window.mstrConfig&&mstrConfig.validateRandNum){tkn=mstrConfig.validateRandNum;}else{if(window.microstrategy!==undefined&&microstrategy&&microstrategy.validateRandNum){tkn=microstrategy.validateRandNum;}}}}catch(err){}return tkn;};mstrmojo.addCSRFTokenToURL=function addCSRFTknToURL(url){if(!url){return"";}var tkn=mstrmojo.getCSRFToken(url);if(tkn&&tkn.length>0){if(url.indexOf("?")>-1){url+="&";}else{url+="?";}url+="validateRandNum="+tkn;}return url;};mstrmojo.addCSRFTokenToTaskParams=function addCSRFTknToTaskParams(params){if(params){var tkn=mstrmojo.getCSRFToken();if(tkn&&tkn.length>0){params.validateRandNum=tkn;}}return params;};mstrmojo.getInstance=function getInstance(config){var Clazz=mstrmojo.hash.walk(config.scriptClass,window);if(Clazz){return new Clazz(config);}return null;};mstrmojo.isUrlExternal=function isUrlExternal(url){var curURL=window.location.href;var servletName=window.mstrApp&&mstrApp.name,taskProcName=window.mstrConfig.taskURL&&mstrConfig.taskURL,isSameWebApp=(url.indexOf("?")===0||url.indexOf(servletName)===0||url.indexOf("./"+servletName)===0||url.indexOf(taskProcName)===0||url.indexOf("./"+taskProcName)===0||url.indexOf(curURL)===0||((curURL.indexOf("?")>0)&&(url.indexOf(curURL.substring(0,curURL.indexOf("?")))===0)));return !isSameWebApp;};mstrmojo.resolveFeature=function resolveFeature(feature){var features=mstrApp.features;return features&&features[feature];};mstrmojo.getStyleRoot=function getStyleRoot(){var c=mstrConfig||{},styleRoot=c.styleRoot||"../style";return styleRoot;};mstrmojo.getJsRoot=getJsRoot;function verifyJsLoaded(name){name=name.trim();var path=name.split(".");var o=window;for(var i=0;i<path.length;i++){o=o[path[i]];if(!o){break;}}return o;}mstrmojo.invalidateJsLoaded=function invalidateJsLoaded(name){var path=name&&name.trim().split("."),len=(path&&path.length)||0,tmp=window,i;for(i=0;i<len-1;i++){if(!tmp){return ;}tmp=tmp[path[i]];}if(tmp&&path[i]){tmp[path[i]]=undefined;}};mstrmojo.util.version=mstrmojo.provide("mstrmojo.util.version",{getResourcePathWithVersion:function(filePath){var versionStr="";if(window.mstrConfig){if(mstrConfig.webVersion){versionStr="?v="+mstrConfig.webVersion+(filePath.indexOf("plugins/")>=0&&mstrConfig.appVersion?"&apv="+mstrConfig.appVersion:"");}}return filePath+versionStr;}});}());(function(){mstrmojo.hash=mstrmojo.provide("mstrmojo.hash",{copy:function N(V,U){if(V){U=U||{};var W;for(W in V){U[W]=V[W];}}return U;},copyProps:function K(W,Y,U){U=U||{};if(Y){var X=(W&&W.length)||0,V;for(V=0;V<X;V++){var Z=W[V];if(Y[Z]!==undefined){U[Z]=Y[Z];}}}return U;},forEach:function Q(X,W,V){if(X){var U;for(U in X){if(V){if(W.call(V,X[U],U,X)===false){break;}}else{if(W(X[U],U,X)===false){break;}}}}return X;},walk:function R(Y,V){if(!V){V=mstrmojo.global;}var X=Y.split(".");if(X.length===1){return V[Y];}var W=(X&&X.length)||0,U;for(U=0;U<W;U++){V=V[X[U]];if(!V){break;}}return V;},walkModify:function D(Z,V,X){if(!V){V=mstrmojo.global;}var Y=Z.split(".");if(Y.length===1){V[Z]=X;return true;}var W=(Y&&Y.length)||0,U;for(U=0;U<W-1;U++){V=V[Y[U]];if(!V){return false;}}V[Y[W-1]]=X;return true;},isEmpty:function H(V){if(!V){return true;}var U;for(U in V){if(V[U]!==null&&V[U]!==undefined){return false;}}return true;},clear:function J(V){if(V){var U;for(U in V){delete V[U];}}return V;},any:function G(X,Y){var W;if(X){var V=this.keyarray(X);if(V.length>0){var U=V[0];W=Y?U:X[U];}}return W;},clone:function S(Y){if(!Y){return null;}var a;if(Y.constructor===Array){a=Y.concat();var Z=a[0];if(Z&&typeof Z==="object"){var U=a.length,X;for(X=0;X<U;X++){a[X]=this.clone(Y[X]);}}}else{a={};var W;for(W in Y){var V=Y[W];if(V&&typeof V==="object"){a[W]=this.clone(V);}else{a[W]=V;}}}return a;},cloneArray:function O(V){var W=[],U=(V&&V.length)||0,X;for(X=0;X<U;X++){W[X]=this.clone(V[X]);}return W;},cloneNoCycle:function E(W){var V=new Map();function U(b){if(b===null||typeof b!=="object"){return b;}if(V.get(b)){return V.get(b);}var Y=Array.isArray(b)?[]:{};V.set(b,Y);var a=Object.keys(b),X=a.length;for(var Z=0;Z<X;Z++){Y[a[Z]]=U(b[a[Z]]);}return Y;}return U(W);},cloneArrayNoCycle:function F(V){var W=[],U=(V&&V.length)||0,X;for(X=0;X<U;X++){W[X]=this.cloneNoCycle(V[X]);}return W;},keyarray:function A(W,X){var U=[],V;if(W){if(Object.keys&&!X){U=Object.keys(W);}else{for(V in W){U.push(X?Number(V):V);}}}return U;},valarray:function I(W){var U=[];if(W){var V;for(V in W){U.push(W[V]);}}return U;},equals:function T(b,a){var V=mstrmojo.hash,Z=(b&&a)||(!b&&!a&&(b===a));if(Z&&b){Z=(b.constructor===a.constructor);if(Z){if(b.constructor===Array){var Y=b.length;Z=(Y===a.length);if(Z&&Y){var W;for(W=0;W<Y;W++){Z=Z&&V.equals(b[W],a[W]);}}}else{if(typeof b==="object"){var c=V.keyarray(b),X=V.keyarray(a);Z=c.length===X.length;if(Z){var U;for(U in b){Z=Z&&(V.equals(b[U],a[U]));}}}else{Z=(b===a);}}}}return Z;},obj2array:function L(Z){var a;for(a in Z){var Y=Z[a];if(Y&&typeof Y==="object"){Z[a]=this.obj2array(Y);}}var V=Z.isArray;if(V!==undefined&&V===true){var X=[],U=Z.length,W;for(W=0;W<U;W++){X.push(Z[W]);}return X;}return Z;},min:function M(X,Y,Z){var U=null,W;if(X){for(W in X){var V=Y?X[W]:W;if(Z){V=Number(V);}if((U===null)||(V<U)){U=V;}}}return U;},max:function P(X,Y,Z){var U=null,W;if(X){for(W in X){var V=Y?X[W]:W;if(Z){V=Number(V);}if((U===null)||(V>U)){U=V;}}}return U;},make:function C(V,W,U){if(!V||!W){return null;}if(V.attachEventListener){return V;}if(W.makeObservable){V=W.makeObservable(V,U)||V;}else{this.copy(W.prototype,V);if(V.init){V=V.init(U)||V;}}return V;},mergeHashes:function B(U,V){U=this.clone(U)||{};if(V){mstrmojo.array.forEach(mstrmojo.array.distinct(this.keyarray(V).concat(this.keyarray(U))),function(W){var Y=U[W],X=V[W];if(Y===undefined){U[W]=X;}else{if(Y!==undefined&&X!==undefined){if(typeof Y==="object"&&Y!==null){if(Y.constructor===Array){U[W]=Y.concat(X);}else{U[W]=this.mergeHashes(Y,X);}}else{U[W]=X;}}}},this);}return U;},invert:function(V){var W={};if(V){var U;for(U in V){if(V.hasOwnProperty(U)){if(typeof U==="number"||typeof U==="string"){W[V[U].toString()]=U;}}}}return W;}});}());(function(){function AX(BC,BD){return BD||(BC||window).event;}function z(BC){var BD=parseInt(BC,10);return BD===null||isNaN(BD)?0:BD;}mstrmojo.PositionType=null;var A7=!!document.all,AV=document.documentMode,AF=navigator.userAgent,y=false,v=false,t=false,s=false,Z=false,X=!A7&&"ActiveXObject" in window,AH=false;A7=A7||X;if(A7){if(window.mstrConfig&&mstrConfig.isEdgeModeEnabled){y=!!AF.match(/MSIE 6/);v=((!!AF.match(/MSIE 7/)&&!AV)||AV===7);t=(AV===8);s=(AV===9);Z=(AV===10);AH=(!AV||AV<=9);}else{y=!!AF.match(/MSIE 6/);v=!!AF.match(/MSIE 7/);t=!!AF.match(/MSIE 8/);s=!!AF.match(/MSIE 9/);Z=!!AF.match(/MSIE 10/);AH=!Z;}}var r=!A7&&!!AF.match(/Firefox/),AA=0,AG=!!AF.match(/Android/),A6=!!AF.match(/DossierMobile/),Aw=!!AF.match(/iPad/),Ad=!!AF.match(/iPhone/),n=!!AF.match(/Macintosh/)&&"ontouchend" in document,Al=!!document.createTouch||AG,AE=!!AF.match(/PlayBook/),V=!!AF.match(/Windows Phone/),A8=!A7&&!!AF.match(/Trident.*rv/),q=r?"-moz-":(A7||A8)?"":"-webkit-",AW=r?"Moz":(Z||A8)?"":A7?"ms":"webkit",Ai=((Z||A8)?"t":"T"),AO="transitionend",Aa="animationend",Ac=AW+Ai+"ransition";var o="mstrevent",C="mstreventmark",N=["showFunctionHelpTopicNode","dynamicClickNode","todoRefactorNode"],h=null;function A1(){return AW+Ai+"ransform";}function AT(){return Ac+"Property";}function b(){return Ac+"Duration";}function U(){return AO;}function u(){return AW+"BoxShadow";}var A4=A1(),Ar=AT(),AN=b(),A=U(),AC=u();function Ah(){if(!AA&&r){var BC=AF.match(/.*Firefox\/([\d|\.]*).*/);if(BC){AA=parseFloat(BC[1]);}}return AA;}function An(){var BD=0,BH=0,BE=window,BF=document,BC=BF.body,BG=BF.documentElement;if(typeof BE.pageYOffset==="number"){BH=BE.pageYOffset;BD=BE.pageXOffset;}else{if(BC&&(BC.scrollLeft||BC.scrollTop)){BH=BC.scrollTop;BD=BC.scrollLeft;}else{if(BG&&(BG.scrollLeft||BG.scrollTop)){BH=BG.scrollTop;BD=BG.scrollLeft;}}}return{x:BD,y:BH};}function AU(BC){BC=BC||0;BC=String(BC);return((BC.indexOf("%",0))!==-1)?BC:(BC+"px");}function Af(BE,BI,BH,BG,BF){if(!mstrmojo.dom.isWinPhone){BG=(BG||false||this.isHWAccelerated);}else{BG=false;}var BD=BF+(BG?"3d":"")+"(",BC=BG?(","+BH+")"):")";return BD+BE+","+BI+BC;}var At=2,g=3;function AI(BK,BI,BM,BD,BN){var BL=BK.style,BG=BL.display,BH=this.windowDim(),BF=An();BL.display="block";var BJ=BH.w-(BD||BK.clientWidth),BO=Math.max(BH.h-(BN||BK.clientHeight),0),BC={4:0,5:BJ,3:BJ/2},BE={1:0,3:BO/2,2:BO};BL.left=BC[BI]+BF.x+"px";BL.top=BE[BM]+BF.y+"px";BL.display=BG;}function AB(BF,BE,BG,BC){if(BF.addEventListener){return BF.addEventListener(BE,BG,!!BC);}BG._id=BG._id||AB.guid++;BF.events=BF.events||{};var BD=BF.events[BE];if(!BD){BD=BF.events[BE]={};if(BF["on"+BE]){BD[0]=BF["on"+BE];}}BD[BG._id]=BG;function BH(BK){BK=BK||window.event;var BJ=this.events[BK.type],BI;for(BI in BJ){BJ[BI].call(this,BK);}}BF["on"+BE]=BH;}AB.guid=1;function w(BE,BD,BF,BC){if(!BE){return ;}if(BE.removeEventListener){BE.removeEventListener(BD,BF,!!BC);}else{if(BE.events&&BE.events[BD]){delete BE.events[BD][BF._id];}}}mstrmojo.Enum_Keys={BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46};mstrmojo.dom=mstrmojo.provide("mstrmojo.dom",{userAgent:AF,isIE:A7,isIE6:y,isIE7:v,isIE8:t,isIE9:s,isIE10:Z,isIE11:X,isIEW3C:A8,isNSIE:AH,isDXIE:AH,isFF:r,isWK:!!AF.match(/AppleWebKit/),isSafari:!!AF.match(/Safari/)&&!AF.match(/Chrome/),isChrome:!!AF.match(/AppleWebKit/)&&AF.match(/Chrome/),isEdge:!!AF.match(/Edge/),isHWAccelerated:!AG,isAndroid:AG,isAndroidLibrary:A6,isIPad:Aw,isIPhone:Ad,isPlayBook:AE,isWinPhone:V,isMobile:Aw||Ad||V||AG,isIOSTouch:(Aw||Ad||n)&&!window.MSStream,supportsTouches:Al,TOUCHSTART:Al?"touchstart":"mousedown",TOUCHMOVE:Al?"touchmove":"mousemove",TOUCHEND:Al?"touchend":"mouseup",TOUCHCANCEL:Al?"touchcancel":"",RESIZE:Al?"orientationchange":"resize",CSS3_PREFIX:q,CSS3_BOXSHADOW:AC,CSS3_TRANSFORM:A4,CSS3_TRANSITION:Ac,CSS3_TRANSITION_PROPERTY:Ar,CSS3_TRANSITION_DURATION:AN,CSS3_TRANSITION_END:A,cssFeatures:{GRADIENTS:"gd",ROUND_CORNERS:"rc",TEXT_ROTATION:"tr",DROP_SHADOW:"sh",INNER_TEXT:"innerText"},htmlFeatures:{FILE_READER:"fr"},MOUSE_BUTTON:{LEFT:1,RIGHT:2},isTouchOptimizationEnabled:function AM(){return A6;},supports:function B(BC){var BD=this.isFF&&Ah();switch(BC){case this.cssFeatures.GRADIENTS:return(this.isIE||this.isIEW3C||this.isWK||BD>=3.6||this.isWinPhone);case this.cssFeatures.ROUND_CORNERS:return(this.isWK||this.isFF||this.isWinPhone||this.isIE10);case this.cssFeatures.TEXT_ROTATION:case this.cssFeatures.DROP_SHADOW:return(this.isIE||this.isWK||BD>=3.5||this.isWinPhone||this.isIE10||this.isIEW3C);case this.htmlFeatures.FILE_READER:return !!(window.FileReader);case this.cssFeatures.INNER_TEXT:return !this.isFF||BD>44;}return false;},getOSInfo:function Ae(){var BC="Unknown",BD=navigator.appVersion,BK=navigator.userAgent,BE=BC;var BJ=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];var BG;for(BG=0;BG<BJ.length;BG++){var BI=BJ[BG];if(BI.r.test(BK)){BE=BI.s;break;}}var BF=BC,BH;if(/Windows/.test(BE)){BH=/Windows (.*)/.exec(BE);BF=BH&&BH[1];BE="Windows";}else{switch(BE){case"Mac OS":BH=/Macintosh.* (\d+[\.\_\d]+)/.exec(BK);BF=BH&&BH[1];break;case"Android":BH=/Android ([\.\_\d]+)/.exec(BK);BF=BH&&BH[1];break;case"iOS":BH=/OS (\d+)_(\d+)_?(\d+)?/.exec(BD);BF=BH&&(BH[1]+"."+BH[2]+"."+(BH[3]|0));break;}}return{name:BE,version:BF||BC};},transitionend:AO,closest:function Au(BD,BC){if(!BD){return null;}if(BD.closest){return BD.closest(BC);}if(!BD.matches){BD.matches=BD.msMatchesSelector||BD.webkitMatchesSelector;}do{if(BD.matches(BC)){return BD;}BD=BD.parentElement||BD.parentNode;}while(BD!==null&&BD.nodeType===1);return null;},animationend:Aa,replace:function AD(BE,BC){if(BE&&BC){var BD=BE.parentNode;if(BD){BD.replaceChild(BC,BE);}}return BC;},attachEvent:function j(BE,BD,BF,BC){if(BE.addEventListener){return BE.addEventListener(BD,BF,!!BC);}return BE.attachEvent("on"+BD,BF);},detachEvent:function Ap(BE,BD,BF,BC){if(!BE){return ;}if(BE.removeEventListener){BE.removeEventListener(BD,BF,!!BC);}else{BE.detachEvent("on"+BD,BF);}},attachMarkupEvent:function AK(BF,BE,BC){var BD=function(BG){mstrmojo.all[BF].captureDomEvent(BC,window,BG);};this.attachEvent(BE,BC,BD);return BD;},attachOneTimeEvent:function i(BF,BD,BG,BC){var BE=function(BH){BG(BH);if(BC){w(this,BD,BE);}else{mstrmojo.dom.detachEvent(this,BD,BE);}};if(BC){AB(BF,BD,BE);}else{this.attachEvent(BF,BD,BE);}BF=null;return BE;},attachMouseMoveEvents:function E(BF,BC){var BE=this,BD=function(BG){if(BC){BC(BG);}BE.detachEvent(document,"mousemove",BF);BE.detachEvent(document,"mouseup",BD);};BE.attachEvent(document,"mousemove",BF);BE.attachEvent(document,"mouseup",BD);},captureDomEvent:function Ab(BH,BF,BD,BG,BE){var BC=mstrmojo.all[BH];if(BC){BC.captureDomEvent(BF,BD,BG,BE);}},captureEventInfo:function AZ(BF){var BD=mstrmojo.hash.copy(BF,{}),BE=BD.hWin=BD.hWin||window,BC=BD.e=BD.e||BE.event;BD.node=this.eventTarget(BE,BC);BD.pos=this.getMousePosition(BC,BE);return BD;},translate:function S(BE,BD,BH,BG,BC,BF){BC=(BC&&" "+BC)||"";BE.style[((mstrmojo.dom.isWinPhone||mstrmojo.dom.isIE9||mstrmojo.dom.isIE10)?"ms":"webkit")+"Transform"]=this.createTranslateString(BD,BH,BG,BF)+BC;},createTranslateString:function W(BC,BF,BE,BD){BC=AU(BC);BF=AU(BF);BE=AU(BE);return Af(BC,BF,BE,BD,"translate");},createScaleString:function AJ(BC,BF,BE,BD){BC=BC||0;BF=BF||0;BE=BE||0;return Af(BC,BF,BE,BD,"scale");},_bufferSize:200,_bufferConnects:{},attachBufferedEvent:function D(BE,BC,BF,BH){var BD=BE.id+"-"+BC,BG=this._bufferConnects[BD];if(!BG){BG=this._bufferConnects[BD]={elId:BE.id,eventName:BC,timer:null,bufferSize:BH,listeners:[],callback:function(BI){mstrmojo.dom._callback(BI,mstrmojo.global,BD);return true;}};this.attachEvent(BE,BC,BG.callback);}BG.listeners.push(BF);},_callback:function A0(BG,BC,BE){var BF=this._bufferConnects[BE],BH=BF&&BF.timer;if(BF&&!BH){var BD=(BF.bufferSize===null)?this._bufferSize:BF.bufferSize;if(BF.bufferSize){BF.timer=BC.setTimeout(function(){mstrmojo.dom.updateBuffers(BE);},BD);}else{mstrmojo.dom.updateBuffers(BE);}}},updateBuffers:function L(BF){var BG=this._bufferConnects[BF],BD=BG&&BG.listeners,BC=(BD&&BD.length)||0,BE;for(BE=0;BE<BC;BE++){BD[BE]();}if(BG&&BG.timer){delete BG.timer;}},detachBufferedEvent:function AR(BD,BH,BI){if(!BD){return ;}var BK=BD.id+"-"+BH,BE=this._bufferConnects[BK],BG=BE&&BE.listeners,BJ=(BG&&BG.length)||0,BF;if(BJ){for(BF=BJ-1;BF>-1;BF--){if(BG[BF]===BI){BG.splice(BF,1);}}if(!BG.length){this.detachEvent(BD,BH,BE.callback);delete this._bufferConnects[BK];if(BE.timer){var BC=mstrmojo.global;BC.clearTimeout(BE.timer);}}}},eventTarget:function AP(BC,BD){BD=AX(BC,BD);return BD&&(BD.target||BD.srcElement);},isMac:function AL(){return this.getOSInfo().name.toLowerCase().indexOf("mac")>=0;},isMetaKey:function P(BC,BF){var BE=this.isMac(),BD=AX(BC,BF)||{};return(BD.ctrlKey&&!BE)||(BD.metaKey&&BE);},ctrlKey:function A3(BC,BD){return(AX(BC,BD)||{}).ctrlKey;},shiftKey:function AQ(BC,BD){return(AX(BC,BD)||{}).shiftKey;},metaKey:function m(BC,BD){return(AX(BC,BD)||{}).metaKey;},getButton:function Aj(BC,BD){return((Number(AX(BC,BD).button))===2)?2:1;},isPrimaryMouseBtn:function Ax(BD,BC){return this.getButton(BC||window,BD)===1;},isRMC:function As(BD,BC){return BD&&(BD.button===2||BD.type==="contextmenu"||this.isMac()&&this.ctrlKey(BC,BD)&&BD.button===0);},getMousePosition:function x(BF,BE){BE=BE||window;var BD,BI;if(mstrmojo.dom.isIE){BF=BF||BE.event;var BG=document,BC=BG.body,BH=BG.documentElement;BD=BF.clientX+BC.scrollLeft+(BH.scrollLeft||0);BI=BF.clientY+BC.scrollTop+(BH.scrollTop||0);}else{BD=BF.pageX;BI=BF.pageY;}return{x:BD,y:BI};},position:function Ak(BD,BE){var BH={x:0,y:0,w:0,h:0};if(BD&&BD.getBoundingClientRect){try{BH=BD.getBoundingClientRect();}catch(BG){BH={left:0,top:0,right:0,bottom:0,height:0,width:0};}BH={x:BH.left,y:BH.top,w:BH.right-BH.left,h:BH.bottom-BH.top};if(this.isIE6||this.isIE7){var BC=BD.ownerDocument;if(BC){var BJ=BC.documentElement,BI=BJ.getBoundingClientRect();BH.x-=BI.left;BH.y-=BI.top;}}}if(BE){var BF=An();BH.x+=BF.x;BH.y+=BF.y;}return BH;},delta:function I(BE,BC){BC=BC||document.body;var BD=this.position(BE),BF=this.position(BC);return{x:Math.round(BD.x-BF.x),y:Math.round(BD.y-BF.y)};},windowDim:function Y(){var BC=0,BE=0,BF=window,BG=document,BH=BG.documentElement,BD=BG.body;if(typeof (BF.innerWidth)=="number"&&typeof (BF.innerHeight)=="number"){BC=BF.innerWidth;BE=BF.innerHeight;}else{if(BH&&(BH.clientWidth||BH.clientHeight)){BC=BH.clientWidth;BE=BH.clientHeight;}else{if(BD&&(BD.clientWidth||BD.clientHeight)){BC=BD.clientWidth;BE=BD.clientHeight;}}}return{w:BC,h:BE};},center:function AY(BE,BD,BC){AI.call(this,BE,g,g,BD,BC);},bottomCenter:function F(BC){AI.call(this,BC,g,At);},clearBrowserHighlights:function Q(BC){BC=BC||self;if(!BC.getSelection){var BI=BC.document,BH=BI&&BI.selection,BF=BH&&BH.empty;if(BF){try{BH.empty();}catch(BE){}}}else{var BD=BC.getSelection,BG=BD&&BC.getSelection();if(BG&&!BG.isCollapsed){if(BG.empty){BG.empty();}else{if(BG.removeAllRanges){BG.removeAllRanges();}}}}},findAncestorByAttr:function Ag(BG,BE,BD,BC){var BH=BD?BG:BG&&BG.parentNode;while(BH&&(BH!==BC)){var BF=BH.getAttribute&&BH.getAttribute(BE);if(BF!=null){return{node:BH,value:BF};}BH=BH.parentNode;}return null;},findAncestorByName:function A2(BE,BH,BD,BC){BH=BH&&BH.toLowerCase();var BF=BD?BE:BE&&BE.parentNode;while(BF&&(BF!==BC)){var BG=BF.nodeName;if(BG&&(BG.toLowerCase()===BH)){return BF;}BF=BF.parentNode;}return null;},findAncestorByClassName:function H(BF,BE,BD,BC){if(!BE||!BE.length){return BF;}var BG=BD?BF:BF&&BF.parentNode;while(BG&&(BG!==BC)){var BH=BG.className&&BG.className.indexOf(BE)!==-1;if(BH){return BG;}BG=BG.parentNode;}},contains:function O(BF,BG,BD,BC){var BE=BG;if(!BD){BE=BE.parentNode;}while(BE){if(BE===BF){return true;}if(BE===BC){break;}BE=BE.parentNode;}return false;},toggleSelection:function A9(BD,BC){BD.setAttribute("unselectable",BC?"off":"on");mstrmojo.css.toggleClass(BD,"unselectable",!BC);BD.onselectstart=function(){return BC;};if(!BC){this.clearBrowserHighlights();}},preventDefault:function d(BC,BD){BD=BD||BC.event;if(BD.preventDefault){BD.preventDefault();}else{BD.returnValue=false;}},stopPropogation:function T(BC,BD){BD=BD||BC.event;if(BD.stopPropagation){BD.stopPropagation();}else{BD.cancelBubble=true;}},firstTouch:function Am(BC,BD){return BD&&BD.touches&&BD.touches.length?BD.touches[0]:(BD||BC.event);},firstChangedTouch:function Av(BC,BD){return BD&&BD.changedTouches&&BD.changedTouches.length?BD.changedTouches[0]:(BD||BC.event);},isLandscape:function c(){return !this.supportsTouches||(Math.abs(window.orientation)===90);},findWidget:function Ao(BC){while(BC){var BD=BC.mstrmojoId;if(BD!==null&&BD!==undefined){return mstrmojo.all[BD];}BC=BC.parentNode;}return null;},isBelongsToTarget:function a(BC,BD){if(!BD||!BC){return false;}while(BC){if(BC===BD){return true;}BC=BC.parentNode;}return false;},setCaret:function J(BC,BE){if(BC.setSelectionRange){BC.focus();BC.setSelectionRange(BE,BE);}else{if(BC.createTextRange){var BD=BC.createTextRange();BD.move("character",BE);BD.select();}}},setInputSelection:function k(BC){if(BC.select){BC.focus();BC.select();}else{if(BC.createTextRange){BC.createTextRange().select();}}},setElementSelection:function p(BE){if(window.getSelection){var BC=document.createRange(),BD=window.getSelection();BC.selectNodeContents(BE);BD.removeAllRanges();BD.addRange(BC);}else{if(document.body.createTextRange){var BF=document.body.createTextRange();BF.moveToElementText(BE);BF.select();}}},getHorizontalScroll:function A5(){return An().x;},getVerticalScroll:function AS(){return An().y;},getMaxScrollHeight:function K(){return mstrmojo.dom.windowDim().h-22;},getComputedScrollbarWidth:function Ay(BD){if(BD){var BC=mstrmojo.css.getComputedStyle(BD);if(BC){return(BD.offsetWidth-z(BC.borderLeftWidth)-z(BC.borderRightWidth)-BD.clientWidth);}}return null;},removeNode:function Az(BE){var BD=document.getElementById(BE),BC=BD&&BD.parentNode;if(BC){return BC.removeChild(BD);}},redirectUrlToFormWrapper:function Aq(BF){var BE=function BE(BH){BH.preventDefault();var BJ=BH.target,BI=BJ&&BJ.href;if(BI&&window&&window.FormWrapper){window.FormWrapper.openPage(BI.replace(/ /g,"%20"));}};var BG=BF&&BF.getElementsByTagName("a"),BD=BG.length;for(var BC=0;BC<BD;BC++){if(!BG[BC].openWithFormWrapper){BG[BC].addEventListener("click",BE,true);BG[BC].openWithFormWrapper=true;}}},checkTagName:function BB(BD,BC){return BD&&BD.tagName&&BD.tagName.toLowerCase()===BC;},getComputedMargin:function G(BD){var BC=mstrmojo.css.getComputedStyle(BD);return[parseInt(BC.marginTop,10)||0,parseInt(BC.marginRight,10)||0,parseInt(BC.marginBottom,10)||0,parseInt(BC.marginLeft,10)||0];},emptyNode:function e(BC){while(BC&&BC.firstChild){BC.removeChild(BC.firstChild);}},inIframe:function f(){try{return window.self!==window.top;}catch(BC){return true;}},isCSPEnabled:function BA(){if(h===null){try{h=!!mstrmojo.hash.walk("features.contentSecurityPolicy",dossierConfig||null);}catch(BC){h=false;}}return h;},recursiveReplaceInlineEventListeners:function M(BD,BC,BF){if(!this.isCSPEnabled()){return ;}var BE=this;function BG(BS,BK){var BQ=BK&&BK.id,BR=BS.getAttribute&&BS.getAttribute(o),BI=BS.getAttribute&&BS.getAttribute(C),BL=BK&&BK.eventHandlerMap,BP;if(BR){var BH=BR.split(" ");for(BP=0;BP<BH.length;BP++){var BO=BH[BP],BM="on"+BO;if(BI){if(N.indexOf(BI)!==-1&&BS.hasAttribute(BM)){BE.singleReplaceInlineEventListeners(BS,BO);}else{if(BL){var BJ=BL[BI]&&BL[BI][BO];if(BJ){BE.singleReplaceInlineEventListenersByMap(BS,BO,BK,BJ);}}}}else{if(BC){BE.attachEvent(BS,BO,function(BT){BE.captureDomEvent(this.wId,this.evtName,self,BT);}.bind({wId:BQ,evtName:BO}));}}}BS.removeAttribute(o);BS.removeAttribute(C);}if(BS.hasChildNodes()){var BN=BS.childNodes;for(BP=0;BP<BN.length;BP++){BG(BN[BP],BK);}}}BG(BD,BF);},singleReplaceInlineEventListeners:function l(BD,BF){var BE="on"+BF,BC=BD.getAttribute(BE);this.attachEvent(BD,BF,function(BG){new Function(BC).bind(BD)(BG);});BD.removeAttribute(BE);},singleReplaceInlineEventListenersByMap:function R(BG,BJ,BI,BC){var BD=BC.requiredParams,BH="on"+BJ;if(BD&&BD.length!==0){var BF={},BE;for(BE=0;BE<BD.length;BE++){BF[BD[BE]]=BI[BD[BE]];}this.attachEvent(BG,BJ,BC.handlerFn(BF));}else{this.attachEvent(BG,BJ,BC.handlerFn());}if(BG.hasAttribute(BH)){BG.removeAttribute(BH);}}});}());(function(){function Z(c){var d=[].slice.call(c),e=d[d.length-1],f=function(h,g){return h===g;};if(/function|string/.test(typeof e)){f=typeof e==="function"?e:function(h,g){return h[e]===g[e];};d=d.slice(0,d.length-1);}return{sets:d,compareFunc:f};}mstrmojo.array=mstrmojo.provide("mstrmojo.array",{indexOf:function E(d,f){var c=(d&&d.length)||0,e;for(e=0;e<c;e++){if(d[e]==f){return e;}}return -1;},includes:function(c,d){if(!c||!c.length){return false;}return c.indexOf(d)>-1;},indexOfMulti:function V(c,d){var h=[],g={},f=0,e=this;e.forEach(c,function(j,i){e.forEach(d,function(k,l){var m=(k===j);if(m){h[l]=g[l]=i;f++;}return !m;});});return{indices:h.length?h:null,map:g,count:f};},forEach:function T(d,j,g){var c=(d&&d.length)||0,e;for(e=0;e<c;e++){var h=e===(c-1);if(g){if(j.call(g,d[e],e,d,h)===false){break;}}else{if(j(d[e],e,d,h)===false){break;}}}return d;},map:function a(d,h){var c=(d&&d.length)||0,e=[],g;for(g=0;g<c;g++){e[g]=h(d[g],g);}return e;},filter:function L(e,f,g){var k=[],j=0,d=(e&&e.length)||0,c=(g&&g.max)||0,h;for(h=0;h<d;h++){if(f(e[h],h,e)){k[j]=e[h];j++;if(c&&j>=c){break;}}}return k;},filterOne:function N(c,d){var e=this.filter(c,d,{max:1});if(e.length){return e[0];}return null;},ensureArray:function R(c){return[].concat(c||[]);},find:function O(d,h,e){var c=(d&&d.length)||0,f;for(f=0;f<c;f++){var g=d[f];if(g&&g[h]==e){return f;}}return -1;},findLast:function B(d,h,e){var c=(d&&d.length)||0,f;for(f=c-1;f>-1;f--){var g=d[f];if(g&&g[h]===e){return f;}}return -1;},distinct:function C(d,h){if(d.reduce&&!h){return d.reduce(function(j,i){if(j.indexOf(i)<0){j.push(i);}return j;},[]);}var c=(d&&d.length)||0,e,g,f=[];for(e=0;e<c;e++){g=d[e];if((g!==undefined)&&((h&&this.find(f,h,g[h])<0)||(!h&&this.indexOf(f,g)<0))){f.push(g);}}return f;},findBin:function F(e,j,k,d){var i=(d||e.length)-1,f=0,c,g=j[k];while(i-f>1){if(e[c=i+f>>1][k]<g){f=c;}else{i=c;}}if(e[f][k]===g){return f;}return e[i][k]===g?i:-1;},search:function J(k,f,i){var g=k.length,e=-1,d,j=f.toUpperCase(),c=f.length;while(g-e>1){if(k[d=g+e>>1][i].substr(0,c).toUpperCase()<j){e=d;}else{g=d;}}return g;},findMulti:function S(l,e,o){if(!o){return{indices:null,map:{},count:0};}var m=o.length,r=[],d={},p=0,g=(l&&l.length)||0,h;for(h=0;h<g;h++){var q=l[h][e],f;for(f=0;f<m;f++){if(o[f][e]===q){r[f]=h;d[f]=h;p++;break;}}}return{indices:r,map:d,count:p};},removeItem:function Y(c,e){var d=this.indexOf(c,e);if(d>-1){this.removeIndices(c,d,1);}return d;},removeItems:function P(c,h,d){var e=this.findMulti(c,h,d);if(e.count){var g=e.indices.concat().sort(this.numSorter).slice(0,e.count),f;for(f=g.length-1;f>-1;f--){c.splice(g[f],1);}}},numSorter:function b(d,c){return Number(d)-Number(c);},stringSorter:function K(e,d){var c=e.toLowerCase(),f=d.toLowerCase();if(c<f){return -1;}if(c>f){return 1;}return 0;},objectKeySorter:function(d,c){if(typeof c==="undefined"){c="asc";}return function(f,e){if(!f.hasOwnProperty(d)||!e.hasOwnProperty(d)){return 0;}var h=(typeof f[d]==="string")?f[d].toUpperCase():f[d];var g=(typeof e[d]==="string")?e[d].toUpperCase():e[d];var i=0;if(h>g){i=1;}else{if(h<g){i=-1;}}return((c==="asc")?i:(i*-1));};},removeIndices:function Q(c,e,d){c.splice(e,d);},insert:function G(d,c,e){if(!d){d=[];}if(c===null||c===undefined){c=d.length;}Array.prototype.splice.apply(d,[c,0].concat(e));return d;},hash:function D(d,f){f=f||{};var c=(d&&d.length)||0,e;for(e=0;e<c;e++){f[d[e]]=true;}return f;},get:function W(d,g){if(!g){return null;}var e=[],c=g.length,f;for(f=0;f<c;f++){e[f]=d[g[f]];}return e;},deepSortArr:function H(d,f,c,e){return d.sort(function(i,g){var j=i[c][f],h=g[c][f];if(!e){return(j<=h);}return(j>h)?-1:1;});},isArray:function(c){var d=Array.isArray;if(d){return d(c);}return Object.prototype.toString.call(c)==="[object Array]";},some:function M(d,e){if(!d){return false;}if(d.some){return d.some(e);}var c=false;this.forEach(d,function(g,f){c=e(g,f,d);return !c;});return c;},difference:function X(){if(arguments.length<2){throw new Error("difference should get at least 2 parameters");}var f=Z(arguments),d=f.sets,e=f.compareFunc,g=d[0],c=[].concat.apply([],d.slice(1));return g.filter(function(h){return !c.some(function(i){return e(h,i);});});},intersection:function U(){if(arguments.length<2){throw new Error("intersection should get at least 2 parameters");}var g=Z(arguments),e=g.sets,f=g.compareFunc,c=e[0],d=e.slice(1);d.forEach(function(h){c=c.filter(function(i){return h.some(function(j){return f(i,j);});});});return c;},fnReduceNumber:function A(c,d){return c+d;},applyLargeArray:function I(f,i,k,l){var g=f.length,j=1000,c,d,e,h=k;if(g){for(c=0,d=j;c<g;c=d,d+=j){e=i.apply(l,f.slice(c,d));h=i.apply(l,[h,e]);}}else{h=i.apply(l,f);}return h;}});}());(function(){var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",G=String.fromCharCode;function D(H){H=H.replace(/\r\n/g,"\n");var I="";for(var K=0;K<H.length;K++){var J=H.charCodeAt(K);if(J<128){I+=G(J);}else{if((J>127)&&(J<2048)){I+=G((J>>6)|192);I+=G((J&63)|128);}else{I+=G((J>>12)|224);I+=G(((J>>6)&63)|128);I+=G((J&63)|128);}}}return I;}function F(L){var H="",J=0,M=0,K=0,I=0;while(J<L.length){M=L.charCodeAt(J);if(M<128){H+=G(M);J++;}else{if((M>191)&&(M<224)){K=L.charCodeAt(J+1);H+=G(((M&31)<<6)|(K&63));J+=2;}else{K=L.charCodeAt(J+1);I=L.charCodeAt(J+2);H+=G(((M&15)<<12)|((K&63)<<6)|(I&63));J+=3;}}}return H;}mstrmojo.base64=mstrmojo.provide("mstrmojo.base64",{decodeHttpHeader:function E(K){var I=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(K&&K.indexOf("=?UTF-8?B?")===0){var J="",H;while((H=I.exec(K))!==null){J+=mstrmojo.base64.decode(H[1]);}return J;}return K;},encode:function B(J){var H="";var Q,O,M,P,N,L,K;var I=0;J=D(J);while(I<J.length){Q=J.charCodeAt(I++);O=J.charCodeAt(I++);M=J.charCodeAt(I++);P=Q>>2;N=((Q&3)<<4)|(O>>4);L=((O&15)<<2)|(M>>6);K=M&63;if(isNaN(O)){L=K=64;}else{if(isNaN(M)){K=64;}}H+=A.charAt(P)+A.charAt(N)+A.charAt(L)+A.charAt(K);}return H;},decode:function C(J){var H="",I=0;var Q,O,M,P,N,L,K;J=J.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(I<J.length){P=A.indexOf(J.charAt(I++));N=A.indexOf(J.charAt(I++));L=A.indexOf(J.charAt(I++));K=A.indexOf(J.charAt(I++));Q=(P<<2)|(N>>4);O=((N&15)<<4)|(L>>2);M=((L&3)<<6)|K;H+=G(Q);if(L!==64){H+=G(O);}if(K!==64){H+=G(M);}}H=F(H);return H;}});})();(function(){var E=new RegExp("^[A-Z0-9]{8}[A-Z0-9]{4}[A-Z0-9]{4}[A-Z0-9]{4}[A-Z0-9]{12}$","i");var A=2147483648;var G=Array.apply(null,Array(256)).map(function(H,I){return(I<16?"0":"")+I.toString(16).toUpperCase();});var F=(window.crypto&&window.crypto.getRandomValues)?function(){var H=new Uint32Array(4);window.crypto.getRandomValues(H);return{d0:H[0],d1:H[1],d2:H[2],d3:H[3]};}:function(){return{d0:Math.abs(Math.floor(Math.random()*A)^(+new Date())),d1:Math.abs(Math.floor(Math.random()*A)^(+new Date())),d2:Math.abs(Math.floor(Math.random()*A)^(+new Date())),d3:Math.abs(Math.floor(Math.random()*A)^(+new Date()))};};function D(H){var L=H.d0,K=H.d1,J=H.d2,I=H.d3;return G[L&255]+G[L>>8&255]+G[L>>16&255]+G[L>>24&255]+G[K&255]+G[K>>8&255]+G[K>>16&15|64]+G[K>>24&255]+G[J&63|128]+G[J>>8&255]+G[J>>16&255]+G[J>>24&255]+G[I&255]+G[I>>8&255]+G[I>>16&255]+G[I>>24&255];}mstrmojo.UUID=mstrmojo.provide("mstrmojo.UUID",{create:function C(){return D(F());},isUUID:function B(H){return H&&E.test(H.toString());}});mstrmojo.UUID.EMPTY="00000000000000000000000000000000";}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var B={};var E={};mstrmojo.publisher=mstrmojo.provide("mstrmojo.publisher",{publish:function F(H,Q,L){var M=B[H]&&B[H][Q],O;if(!M){return ;}for(O in M){var J=null;if(O){J=mstrmojo.all[O];if(!J){delete M[O];continue;}}var R=M[O].methods;if(R){var P=J||mstrmojo.global,I;for(I in R){if(P[I]){P[I](L);}}}var N=M[O]&&M[O].functions,S=(N&&N.length)||0;if(S){var K;if(J){for(K=S-1;K>-1;K--){if(N[K]){N[K].apply(J,[L]);}}}else{for(K=S-1;K>-1;K--){if(N[K]){N[K](L);}}}}}},subscribe:function D(I,N,R,J){var S=B[I];if(!S){S={};B[I]=S;}var M=S[N];if(!M){M={};S[N]=M;}var K=M[J||""];if(!K){K={};M[J||""]=K;}if(typeof R==="function"){var L=K.functions;if(!L){L=[];K.functions=L;}L.push(R);}else{var H=K.methods;if(!H){H={};K.methods=H;}H[R]=true;}var Q=E,P=Q[J||""];if(!P){P={};Q[J||""]=P;}var O=P[I];if(!O){O={};P[I]=O;}O[N]=true;return{id:I,type:N,callback:R,listener:J,clear:function(){mstrmojo.publisher.unsubscribe(this);}};},unsubscribe:function C(I){var R=B[I.id],O=R&&R[I.type],L=O&&O[I.listener||""];if(!L){return ;}var K=mstrmojo.array,Q=mstrmojo.hash,P=typeof I.callback,M=false;if(P==="function"){var N=L.functions;if(N){K.removeItem(N,I.callback);if(!N.length){delete L.functions;if(Q.isEmpty(L.methods)){M=true;}}}}else{var J=L.methods;if(J){delete J[I.callback];if(Q.isEmpty(J)){delete L.methods;if(!L.functions||!L.functions.length){M=true;}}}}if(M){delete O[I.listener||""];if(Q.isEmpty(O)){delete R[I.type];}}},hasSubs:function G(K,J){var I=B[K],H=I&&I[J];return !!H;},clearSubscriptions:function A(I){if(!I){I="";}var P=B,M=mstrmojo.hash,H;if(P[I]){delete P[I];}var O=E[I];if(O){for(H in O){var N=P[H],L=O[H],K;if(!N){continue;}for(K in L){var J=N[K];if(!J){continue;}delete J[I];if(M.isEmpty(J)){delete N[K];}}}}delete E[I];}});mstrmojo.publisher.NO_SRC="NO_SRC";mstrmojo.publisher.CONNECTIVITY_CHANGED_EVENT="CONNECTIVITY_CHANGED";mstrmojo.publisher.RECONCILE_END_EVENT="RECONCILE_END";}());(function(){mstrmojo.requiresCls("mstrmojo.array");function C(G,H,E){var F=G.createElement("input");F.name=H;F.type="hidden";F.value=E;return F;}function B(K,J){J=J.substring(J.indexOf("?")+1,J.length);var M=J.split("&"),L="",G="";var N=/\+/g,H,E;for(H=0,E=M.length;H<E;H++){var I=M[H].indexOf("=");if(I>=0){L=M[H].substring(0,I);G=M[H].substring(I+1);}else{L=M[H];G="";}if(G){G=decodeURIComponent(G.replace(N," "));}var F=document.createElement("INPUT");F.type="HIDDEN";F.name=L;F.value=G;K.appendChild(F);}return false;}mstrmojo.form={createDynamicForm:function A(E,H){var F=document.createElement("FORM"),G=E.indexOf("?")>0;F.name="dynamic_form";F.method=H||"POST";F.action=(G?E.substring(0,E.indexOf("?")):E);if(G){B(F,E);}document.body.appendChild(F);return F;},sendLinkAsForm:function(E,G,H){var F=this.createDynamicForm(E,H);this.send({},F.action,F.method,G,null,null,F);},sendLink:function(E,H,I){var G=mstrmojo.array.indexOf(["_new","_blank"],H)>-1,F=!mstrmojo.isUrlExternal(E);if(!G&&F){mstrApp.showWait&&mstrApp.showWait({showCancel:true,onCancel:mstrApp.hideWait});}if(!mstrmojo.isUrlExternal(E)){mstrmojo.form.sendLinkAsForm(E,H,I);}else{if(G){window.open(E,H,"noopener,noreferrer");}else{window.location.href=E;}}},createHiddenInput:function(G,F,H){var I=window.document;var E=C(I,F,H);G.insertAdjacentElement("beforeEnd",E);return E;},send:function D(L,M,F,O,J,H,G){var Q=((J&&J.hWin)||window).document,N=G||Q.createElement("form"),K=mstrApp;L=mstrmojo.addCSRFTokenToTaskParams(L);N.method=F||"POST";if(O){N.target=O;}N.action=M||K.name;H=(H!==undefined)?H:!(N.action&&N.action.indexOf("aspx")>0)&&mstrConfig.addTimeStampToPreventCaching;if(!!K.addJSessionIdToURL&&K.httpSessionId){N.action+=";jsessionid="+K.httpSessionId;}if(H){N.action+=";uxts"+mstrmojo.now();}N.appendChild(C(Q,"xts",String(mstrmojo.now())));var R,E=K.persistTaskParams||microstrategy.persistParams;for(R in E){L[R]=E[R];}if(K.servletState&&K.name){L[K.name]=K.servletState;}else{if(microstrategy&&microstrategy.servletName&&microstrategy.servletState){L[microstrategy.servletName]=microstrategy.servletState;}}if(L){if(N.method.toLowerCase()==="get"){delete L.validateRandNum;}var I;for(I in L){if(mstrmojo.array.isArray(L[I])){mstrmojo.array.forEach(L[I],function(S){N.appendChild(C(Q,I,S));});}else{N.appendChild(C(Q,I,L[I]));}}}Q.body.appendChild(N);try{this.safeSubmitForm(N);}catch(P){if(O&&P.result===2147500037&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){mstrmojo.alert("*This action requires popups to be allowed in the browser.*");}else{mstrmojo.err("Form submission failed for an unknown reason.");}}},addURLAsHiddenInputsToForm:B,safeSubmitForm:function(J,I){if(!J){return ;}try{if(J.target==="_blank"){var H=J.action;var G=J.cloneNode(true);G.target="_self";var K=window.open("");K.opener=null;var F=K.contentDocument||K.document;G.action=H;F.body.insertAdjacentElement("beforeEnd",G);G.submit();}else{J.submit();}}finally{if(!I){var E=J.parentElement;if(E){E.removeChild(J);}}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var O=/\{\@(en@)?([^\}]+)\}/gm,K=/\</gm,U=/\>/gm,F=/\S/,S=["$","^","=","!",":","/",".","*","+","?","|","(",")","[","]","{","}","\\"],G=new RegExp("(\\"+S.join("|\\")+")","g"),V={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;","\u0009":"&#x09;","\n":"&#x0A;","\r":"&#x0D;",'"':"&quot;"},Y={"&amp;":"&","&lt;":"<","&gt;":">","&#x09;":"\u0009","&#x0A;":"\n","&#x0D;":"\r","&quot;":'"',"&#039;":"'"},D={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;"," ":"&nbsp;","\n":"<br/>","\r":"&nbsp;&nbsp;&nbsp;&nbsp;","'":"&#39;",'"':"&#34;"},N={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":" ","<br/>":"\n","&nbsp;&nbsp;&nbsp;&nbsp;":"\r","&#39;":"'","&#039;":"'","&#34;":'"',"&quot;":'"',},E={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&#34;","\u20ac":"&#8364;"},L={"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&#34;":'"',"&#8364;":"\u20ac"};var M=function(Z){if(Z===null){return"null";}var a=typeof Z;if(a!=="object"){return a;}if(Z.length===undefined){return"object";}return"array";};var W={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};mstrmojo.string=mstrmojo.provide("mstrmojo.string",{multiReplace:function H(a,d,c){var Z;c=c||[];if(!a){return"";}var b=[];for(Z in d){if(mstrmojo.array.indexOf(c,Z)===-1){b.push(Z.k||Z);}}return a.replace(new RegExp(b.join("|"),"g"),function(e){var f=d[e];return f.v||f;});},trim:function R(Z){return(Z&&Z.replace)?Z.replace(/^\s+/,"").replace(/\s+$/,""):Z;},startsWith:function X(a,Z){return a.length>=Z.length&&a.substring(0,Z.length)===Z;},endsWith:function T(a,Z){return a.length>=Z.length&&a.substring(a.length-Z.length)===Z;},ellipsize:function A(b,a){var Z=this.trim(b.substr(0,(a||1)-1));if(Z!==b){Z+="&hellip;";}return Z;},isEmpty:function J(Z){return(Z===null)||(Z===undefined)||!(F.test(Z));},regEscape:function Q(Z){return Z.replace(G,"\\$1");},escapeIllegalXML:function C(Z){if(!Z||!Z.replace){return Z;}var a=/\u001a/gm,b="";return Z.replace(a,b);},encodeXMLAttribute:function(Z){return mstrmojo.string.multiReplace(Z,V);},decodeXMLAttribute:function(Z){return mstrmojo.string.multiReplace(Z,Y);},encodeHtmlString:function(a,Z,b){if(!a||!a.replace){return a;}if(b){return mstrmojo.string.multiReplace(a,E);}return mstrmojo.string.multiReplace(a,D,Z?[" "]:[]);},decodeHtmlString:function(a,Z){return Z?mstrmojo.string.multiReplace(a,L):mstrmojo.string.multiReplace(a,N);},htmlAngles:function(Z){if(!mstrmojo.string.isEmpty(Z)){Z=String(Z);return Z.replace(K,"&lt;").replace(U,"&gt;");}return Z;},apply:function I(Z,b){if(!Z){return"";}var a=this;return Z.replace(O,function c(f,g,h){var d;try{d=mstrmojo.hash.walk(h,b);if(typeof d==="function"){d=d.call(b);}}catch(e){}d=(d===null||d===undefined)?"":d;return(!!g)?a.encodeHtmlString(d,true):d;});},json2xml:function(Z,p,q){if(!(p instanceof Array)){p=[p];}var a=q&&q.isSerializable,o=(q.convertBoolean!==false),s=q&&q.skipFunctions,m,f;var h=[],d=[],g,c,e;for(m=0,f=p.length;m<f;m++){var l=p[m];for(g in l){if(s&&typeof l[g]==="function"){continue;}if(a){var r=a(g,p,m);if(r!==true){if(r===false){continue;}else{if(r.att){h.push(r.att);}if(r.child){d.push(r.child);}continue;}}}c=l[g];e=M(c);switch(e){case"array":var j,k;d.push("<"+g+">");for(j=0,k=c.length;j<k;j++){var b=q.getArrItemName(g,c,j)||j;d.push(this.json2xml(b,c[j],q));}d.push("</"+g+">");break;case"object":d.push(this.json2xml(g,c,q));break;case"string":h.push(g+'="'+mstrmojo.string.encodeXMLAttribute(c)+'"');break;case"boolean":h.push(g+'="'+(o?(c?"-1":"0"):c)+'"');break;case"null":if(!q.skipNull){h.push(g+'="'+q.nullValue+'"');}break;default:h.push(g+'="'+c+'"');break;}}}return"<"+Z+" "+h.join(" ")+">"+d.join("")+"</"+Z+">";},escape4HTMLText:function B(g){if(!g||!g.replace){return g;}var d=/"/gm;var b="&quot;";var h=/&/gm;var f="&amp;";var e=/</gm;var Z="&lt;";var c=/>/gm;var a="&gt;";return g.replace(h,f).replace(d,b).replace(e,Z).replace(c,a);},parseUri:function(d,a){a=a||W;var Z=a.parser[((a.strictMode)?"strict":"loose")].exec(d),c={},b=14;while(b--){c[a.key[b]]=Z[b]||"";}c[a.q.name]={};c[a.key[12]].replace(a.q.parser,function(f,e,g){if(e){c[a.q.name][e]=g;}});return c;},removeSpecialChars:function(Z){return Z.replace(/[^a-zA-Z0-9]/g,"");},hashCode:function P(Z){return Z.split("").reduce(function(d,c){d=((d<<5)-d)+c.charCodeAt(0);return d&d;},0);}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.requiresDescs(521,522,523,524,525,526,529,530,534,535,546,547,587,686,687,688,696,746,949,950,952,953,954,955,956,1035,1101,1102,1375,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,2171,2202,2203,2204,2219,2220,2295,2784,2785,2786,2795,2796,2816,2903,3086,3344,3852,3853,3854,3855,3856,3857,3858,3859,3860,3861,3862,3863,3945,3946,4406,4407,4737,4738,4739,4740,4998,5282,5283,5924,5925,6047,6076,6077,6078,6079,6080,6081,6082,6114,7899,7900,7901,7902,7903,9379,9380,9381,9382,9383,9384,9385,12298,13889,13890,13896,13897);mstrmojo.locales=mstrmojo.provide("mstrmojo.locales",{load:function(D){var B=this;if(this.isLoaded){D();D=null;}else{var C={taskId:"getLocaleInfo"};if(mstrConfig&&mstrConfig.isAddSessionState&&mstrApp&&mstrApp.sessionState){C.sessionState=mstrApp.sessionState;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(E){B.update(E);D();D=null;if(mstrmojo.expr){mstrmojo.expr.onLocaleUpdated();}mstrmojo.locales.isLoaded=true;},failure:function(E){alert(E.getResponseHeader("X-MSTR-TaskFailureMsg"));}},C);}},update:function(B){if(B){mstrmojo.hash.copy(mstrmojo.hash.obj2array(B),this);}},isRTL:function A(B){return false;switch(B){case"1025":case"5121":case"15361":case"3073":case"2049":case"11265":case"13313":case"12289":case"4097":case"6145":case"8193":case"16385":case"10241":case"7169":case"14337":case"9217":case"1125":case"1065":case"1037":case"1114":case"1056":case"2080":return true;default:return false;}},isLoaded:false,datetime:{MONTHNAME_SHORT:[mstrmojo.desc(3852,"Jan"),mstrmojo.desc(3853,"Feb"),mstrmojo.desc(3854,"Mar"),mstrmojo.desc(3855,"Apr"),mstrmojo.desc(3856,"May"),mstrmojo.desc(3857,"Jun"),mstrmojo.desc(3858,"Jul"),mstrmojo.desc(3859,"Aug"),mstrmojo.desc(3860,"Sep"),mstrmojo.desc(3861,"Oct"),mstrmojo.desc(3862,"Nov"),mstrmojo.desc(3863,"Dec")],MONTHNAME_FULL:[mstrmojo.desc(1956,"January"),mstrmojo.desc(1957,"February"),mstrmojo.desc(1958,"March"),mstrmojo.desc(1959,"April"),mstrmojo.desc(1960,"May"),mstrmojo.desc(1961,"June"),mstrmojo.desc(1962,"July"),mstrmojo.desc(1963,"August"),mstrmojo.desc(1964,"September"),mstrmojo.desc(1965,"October"),mstrmojo.desc(1966,"November"),mstrmojo.desc(1967,"December")],dayShortNames:[mstrmojo.desc(1968,"S"),mstrmojo.desc(1969,"M"),mstrmojo.desc(1970,"T"),mstrmojo.desc(1971,"W"),mstrmojo.desc(1972,"T"),mstrmojo.desc(1973,"F"),mstrmojo.desc(1974,"S")],dayNames:[mstrmojo.desc(9379,"Sunday"),mstrmojo.desc(9380,"Monday"),mstrmojo.desc(9381,"Tuesday"),mstrmojo.desc(9382,"Wednesday"),mstrmojo.desc(9383,"Thursday"),mstrmojo.desc(9384,"Friday"),mstrmojo.desc(9385,"Saturday")],DATEINPUTFORMATS:["M/d/yy","M/d/yyyy","MMM d, yy"],TIMEINPUTFORMATS:["h:mm a","H:mm","h:mm:ss a","H:mm:ss","h:mm:ss a z"],DATEOUTPUTFORMAT:"M/d/yyyy",TIMEOUTPUTFORMAT:"h:mm:ss a",DATEDISPLAYFORMAT:"M/d/yy",TIMEDISPLAYFORMAT:"h:mm:ss",AM_NAME:"AM",PM_NAME:"PM",TWODIGITYEARSTART:"2029"},location:{LOCALE_TO_LANG:{"2052":mstrmojo.desc(2816,"Chinese (Simplified)"),"1028":mstrmojo.desc(2903,"Chinese (Traditional)"),"1030":mstrmojo.desc(4998,"Danish"),"1043":mstrmojo.desc(4737,"Dutch (Netherlands)"),"1031":mstrmojo.desc(949,"German"),"1033":mstrmojo.desc(950,"English (US)"),"2057":mstrmojo.desc(2295,"English (UK)"),"1036":mstrmojo.desc(952,"French"),"4108":mstrmojo.desc(4738,"French (Switzerland)"),"2060":mstrmojo.desc(6114,"French (Belgium)"),"2055":mstrmojo.desc(4739,"German (Switzerland)"),"1040":mstrmojo.desc(953,"Italian"),"2064":mstrmojo.desc(4740,"Italian (Switzerland)"),"1041":mstrmojo.desc(954,"Japanese"),"1042":mstrmojo.desc(955,"Korean"),"1045":mstrmojo.desc(6047,"Polish"),"1046":mstrmojo.desc(1035,"Portugese (Brasil)"),"3082":mstrmojo.desc(1375,"Spanish"),"1053":mstrmojo.desc(956,"Swedish")}},number:{NUMBERINPUTFORMATS:{"0":"#,##0.###"},INTEGERINPUTFORMATS:{"0":"#,##0"},NUMBEROUTPUTFORMAT:"#0.##########",INTEGEROUTPUTFORMAT:"#0",DECIMALSEPARATOR:".",THOUSANDSEPARATOR:","},expression:{METRICVALIDATIONLEVEL:"0",PRESERVEWHITESPACE:false,Include:[{did:"1",n:mstrmojo.desc(3945,"Include")},{did:"2",n:mstrmojo.desc(3946,"Exclude")}],BranchQual:[{did:"19",n:mstrmojo.desc(5282,"AND")},{did:"20",n:mstrmojo.desc(5283,"OR")},{did:"21",n:mstrmojo.desc(12298,"NOT")},{did:"19_21",n:mstrmojo.desc(5924,"AND NOT")},{did:"20_21",n:mstrmojo.desc(5925,"OR NOT")}],RootOperator:[{did:"19",n:mstrmojo.desc(534,"All selections")},{did:"20",n:mstrmojo.desc(535,"Any selection")}],ExprType:[{did:"2",n:mstrmojo.desc(546,"Qualify")},{did:"5",n:mstrmojo.desc(547,"Select")}],DimtyLevels:[{did:"1",n:mstrmojo.desc(2171,"Default")},{did:"2",n:mstrmojo.desc(3086,"Metric")},{did:"3",n:mstrmojo.desc(3344,"Report")}],Attribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,76",n:mstrmojo.desc(686,"Contains"),t:1,tp:1},{did:"1,79",n:mstrmojo.desc(2784,"Does not contain"),t:1,tp:1},{did:"1,77",n:mstrmojo.desc(687,"Begins with"),t:1,tp:1},{did:"1,80",n:mstrmojo.desc(2785,"Does not begin with"),t:1,tp:1},{did:"1,78",n:mstrmojo.desc(688,"Ends with"),t:1,tp:1},{did:"1,81",n:mstrmojo.desc(2786,"Does not end with"),t:1,tp:1},{did:"1,18",n:mstrmojo.desc(525,"Like"),t:1,tp:1},{did:"1,43",n:mstrmojo.desc(526,"Not Like"),t:1,tp:1},{did:"1,54",n:mstrmojo.desc(2202,"Is Null"),t:1,tp:1},{did:"1,55",n:mstrmojo.desc(2203,"Is Not Null"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1}],Metric:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,54",n:mstrmojo.desc(2202,"Is Null"),t:1,tp:1},{did:"1,55",n:mstrmojo.desc(2203,"Is Not Null"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1},{did:"2,1",n:mstrmojo.desc(529,"Highest"),t:2,tp:2},{did:"2,2",n:mstrmojo.desc(530,"Lowest"),t:2,tp:2},{did:"3,1",n:mstrmojo.desc(4407,"Highest %"),t:3,tp:3},{did:"3,2",n:mstrmojo.desc(4406,"Lowest %"),t:3,tp:3}],MetricRP:[{did:"2,13",n:mstrmojo.desc(13897,"Rank between highest"),t:2,tp:2},{did:"2,4",n:mstrmojo.desc(1101,"Exclude highest"),t:2,tp:2},{did:"2,3",n:mstrmojo.desc(13896,"Rank between lowest"),t:2,tp:2},{did:"2,5",n:mstrmojo.desc(1102,"Exclude lowest"),t:2,tp:2},{did:"3,13",n:mstrmojo.desc(13890,"Between highest")+"%",t:3,tp:3},{did:"3,4",n:mstrmojo.desc(1101,"Exclude highest")+"%",t:3,tp:3},{did:"3,3",n:mstrmojo.desc(13889,"Between lowest")+"%",t:3,tp:3},{did:"3,5",n:mstrmojo.desc(1102,"Exclude lowest")+"%",t:3,tp:3}],MDXAttribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1}],MDXMetric:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1}],SAPAttribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1}],Element:[{did:"1,22",n:mstrmojo.desc(2219,"In List"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2220,"Not In List"),t:1,tp:1}]},validation:{requiredFieldError:mstrmojo.desc(6078,"This field is required."),invalidCharError:mstrmojo.desc(7899,"This field contains invalid characters for #."),invalidDateStringError:mstrmojo.desc(7900,"This field contains invalid date/time string."),invalidNumericFormatError:mstrmojo.desc(7901,"This field contains numeric value with incorrect format."),outofRangeError:mstrmojo.desc(6079,"This field should be # between ## and ###."),noLessMinError:mstrmojo.desc(6081,"This field should be # greater than or equal to ##."),noGreaterMaxError:mstrmojo.desc(6080,"This field should be # less than or equal to ###."),failRegexTestError:mstrmojo.desc(6082,"This field failed regular expression validation."),invalidValueInListError:mstrmojo.desc(7902,"One of the value (#) in this list is not valid."),integerDataType:mstrmojo.desc(6076,"an Integer value"),numericDataType:mstrmojo.desc(6077,"a Number value"),dateDataType:mstrmojo.desc(7903,"a Date/Time value")},color:{colors:[{n:"Black",v:"#000000"},{n:"Brown",v:"#993300"},{n:"Olive Green",v:"#333300"},{n:"Dark Green",v:"#003300"},{n:"Dark Teal",v:"#003366"},{n:"Dark Blue",v:"#000080"},{n:"Indigo",v:"#333399"},{n:"Grey-80%",v:"#333333"},{n:"Dark Red",v:"#800000"},{n:"Orange",v:"#FF6600"},{n:"Dark Yellow",v:"#808000"},{n:"Green",v:"#008000"},{n:"Teal",v:"#008080"},{n:"Blue",v:"#0000FF"},{n:"Blue-Grey",v:"#666699"},{n:"Grey-50%",v:"#808080"},{n:"Red",v:"#FF0000"},{n:"Light Orange",v:"#FF9900"},{n:"Lime",v:"#99CC00"},{n:"Sea Green",v:"#339966"},{n:"Aqua",v:"#33CCCC"},{n:"Light Blue",v:"#3366FF"},{n:"Violet",v:"#800080"},{n:"Grey-40%",v:"#969696"},{n:"Pink",v:"#FF00FF"},{n:"Gold",v:"#FFCC00"},{n:"Yellow",v:"#FFFF00"},{n:"Bright Green",v:"#00FF00"},{n:"Turquoise",v:"#00FFFF"},{n:"Sky Blue",v:"#00CCFF"},{n:"Plum",v:"#993366"},{n:"Grey-25%",v:"#C0C0C0"},{n:"Rose",v:"#FF99CC"},{n:"Tan",v:"#FFCC99"},{n:"Light Yellow",v:"#FFFF99"},{n:"Light Green",v:"#CCFFCC"},{n:"Light Turquoise",v:"#CCFFFF"},{n:"Pale Blue",v:"#99CCFF"},{n:"Lavender",v:"#CC99FF"},{n:"White",v:"#ffffff"}],userPalette:[{n:"#F00E0E",v:"#F00E0E"},{n:"#080000",v:"#080000"},{n:"#E81A1A",v:"#E81A1A"},{n:"#6E0909",v:"#6E0909"},{n:"#4F2828",v:"#4F2828"},{n:"#141212",v:"#141212"},{n:"#D60202",v:"#D60202"},{n:"#C40404",v:"#C40404"}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var F=mstrmojo.hash;mstrmojo.func=mstrmojo.provide("mstrmojo.func",{composite:function G(H){if(!H||!H.length){return mstrmojo.emptyFn;}return function(){var I=H.length,J;for(J=0;J<I;J++){H[J].apply(this,arguments);}};},wrapMethods:function E(M,K){function L(O,N){N=N||{};mstrmojo.hash.forEach(O,function(P,Q){N[Q]=(N.hasOwnProperty(Q)&&typeof P==="function")?mstrmojo.func.composite([P,N[Q]]):P;});return N;}if(arguments.length<3){return L(M,K);}var I=arguments.length,J=[].slice.call(arguments,0,I-1).reverse(),H=arguments[I-1];mstrmojo.array.forEach(J,function(N){H=L(N,H);});return H;},wrapMethodHandlers:function C(M,K){function L(Q,N){N=N||{};var P=Q.handlerName,O=N.handlerName;if(!N.hasOwnProperty("removeHandler")){N.removeHandler=function(S,V){var R=N[V+"Array"],U=mstrmojo.array.find(R,"handlerName",this.curHandlerName),T;if(U>-1){for(T=U+1;T<R.length;T++){if(R[T].handlerName===S){R.splice(T,1);break;}}}};}mstrmojo.hash.forEach(Q,function(R,T){if(typeof R==="function"&&T!=="removeHandler"){var S=T+"Array";Q[S]=Q[S]||[{handlerName:P,fn:R}];if(!N[T]){N[T]=function(){var V=N[S],U;for(U=0;U<V.length;U++){this.curHandlerName=V[U].handlerName;V[U].fn.apply(this,arguments);}};}}});mstrmojo.hash.forEach(N,function(S,U){if(typeof S==="function"&&U!=="removeHandler"){var T=U+"Array",R=N[T]=(Q[T]||[]).concat(N[T]||[{handlerName:O,fn:S}]);N[U]=function(){var W=R,V;for(V=0;V<W.length;V++){this.curHandlerName=W[V].handlerName;W[V].fn.apply(this,arguments);}};}});return N;}if(arguments.length<3){return L(M,K);}var I=arguments.length,J=[].slice.call(arguments,0,I-1).reverse(),H=arguments[I-1];mstrmojo.array.forEach(J,function(N){H=L(N,H);});return H;},override:function B(J,H){var I=function(M,L){return function K(){var O=this._super,N;this._super=L||mstrmojo.emptyFn;try{N=M.apply(this,arguments||[]);}finally{this._super=O;}return N;};};H=H||{};mstrmojo.hash.forEach(J,function(K,L){H[L]=I(K,H[L]);});return H;},throttle:function(J,L,H){var I,N,Q,O=null,M=0,P=H||{};var K=function(){M=P.leading===false?0:mstrmojo.date.now();O=null;Q=J.apply(I,N);I=N=null;};return function(){var R=mstrmojo.date.now();if(!M&&P.leading===false){M=R;}var S=L-(R-M);I=this;N=arguments;if(S<=0){clearTimeout(O);O=null;M=R;Q=J.apply(I,N);I=N=null;}else{if(!O&&P.trailing!==false){O=setTimeout(K,S);}}return Q;};},debounce:function(K,M,J){var P,O,I,N,Q,H=mstrmojo.date.now;var L=function(){var R=H()-N;if(R<M){P=setTimeout(L,M-R);}else{P=null;if(!J){Q=K.apply(I,O);I=O=null;}}};return function(){I=this;O=arguments;N=H();var R=J&&!P;if(!P){P=setTimeout(L,M);}if(R){Q=K.apply(I,O);I=O=null;}return Q;};},addMethods:function D(I,H){H=H||{};mstrmojo.hash.forEach(I,function(J,K){if(!H.hasOwnProperty(K)&&typeof J==="function"){H[K]=J;}});return H;},safeCall:function A(L,J){var N=F.walk(L,J),M=L.split("."),I=J,K;if(N&&N instanceof Function){if(M.length>1){M.pop();K=M.join(".");I=F.walk(K,J);}return function H(){return N.apply(I,arguments);};}return mstrmojo.emptyFn;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.all={};var E=mstrmojo.all,G=mstrmojo.hash;var A=0;function D(){var I;while(!I){var H="mstr"+(A++);if(!E[H]){I=H;}}return I;}mstrmojo.registry=mstrmojo.provide("mstrmojo.registry",{add:function F(H){if(!H){return ;}var I=H.id;if(!I){H.id=I=D();}else{if(E[I]){throw new Error("Tried to register 2 objects with same id: "+I);}}E[I]=H;},remove:function C(H){if(H&&H.id){delete E[H.id];}},dumpAll:function(){var H;for(H in E){var I=E[H].id;if(I){mstrmojo.dbg(I+"("+(E[H].scriptClass||"[unknown class]")+")");}}},ref:function B(I,H){H=H||{};if(I){var L=I;while(L){switch(typeof L){case"string":if(H.skipLoadChecks!==true){mstrmojo.requiresCls(L);}L=G.walk(L,window);break;case"function":return(H.dontInst!==true)?new L():L;case"object":if(L.constructor===Object){var K=L.scriptClass;if(K){if(H.skipLoadChecks!==true){mstrmojo.requiresCls(K);}var J=G.walk(K,window);if(J){return new J((H.clone===true)?G.clone(L):L);}return null;}return L;}return L;default:return null;}}}return null;}});mstrmojo.insert=mstrmojo.registry.ref;}());(function(){mstrmojo.requiresCls("mstrmojo.base64","mstrmojo.func","mstrmojo.hash","mstrmojo.string","mstrmojo.dom");mstrmojo.XhrCallbackType=null;function decodeHeader(value){var rEncoded=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(value&&value.indexOf("=?UTF-8?B?")===0){var decMsg="",result;while((result=rEncoded.exec(value))!==null){decMsg+=mstrmojo.base64.decode(result[1]);}return decMsg;}return value;}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){url[++x]=p+"="+encodeURIComponent(params[p]);}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function checkToAddRequestHeadersForXhr(xhr,params){var headers=params.xhrHeaders;if(headers){for(var hdr in headers){xhr.setRequestHeader(hdr,headers[hdr]);}delete params.xhrHeaders;}}function sendXhr(xhr,method,baseUrl,params){method=method.toUpperCase();var app=mstrApp,m=window.microstrategy;if(this.isTask){params=mstrmojo.addCSRFTokenToTaskParams(params);params.taskContentType=params.taskContentType||"json";params.taskEnv=params.taskEnv||"xhr";params.xts=new Date().getTime();params[mstrApp.name]=mstrApp.servletState||mstrConfig.servletState||"";baseUrl=baseUrl||mstrConfig.taskURL;}var hasUserDefinedMimeType=params.hasUserDefinedMimeType;delete params.hasUserDefinedMimeType;var ptp=app.persistTaskParams||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}xhr.open(method,appendUrlParams(method,baseUrl,params),this.async);if(hasUserDefinedMimeType){xhr.overrideMimeType("text/plain; charset=x-user-defined");}checkToAddRequestHeadersForXhr(xhr,params);if(method!=="POST"){xhr.send(null);}else{xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.send(encodeParams(params));}if(this.async===false){xhr.onreadystatechange();}}function createXhr(){var methods=[function(){var res=new XMLHttpRequest();var foo=res.open;res.open=function(){foo.apply(res,arguments);};return res;},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");}],cnt=methods.length,i;for(i=0;i<cnt;i++){var xhr;try{xhr=methods[i]();}catch(e){continue;}createXhr=methods[i];return xhr;}throw new Error("mstrmojo.SimpleXHR: Could not create an XHR object.");}function evalResponse(rt){var rtn=null;try{try{rtn=JSON.parse(rt);}catch(ex){rtn=eval("("+rt+")");}}catch(ex){rtn=rt&&mstrmojo.string.trim(rt);}return rtn;}var MSI_SERVER_NAME_NOT_INITIALIZED=2147760371,MSI_INVALID_SESSION_ID=2147760372,E_MSI_USERMGR_USER_NOTFOUND=2147758245,E_MSI_CONNECT_FAILED=2147759877,CSRF_ERROR=4098;function isSessionExpiredError(res){if(res.status===401){return true;}var c=res&&res.getResponseHeader("X-MSTR-TaskErrorCode");c=(c<0)?(4294967296+parseInt(c,10)):c;switch(c){case MSI_SERVER_NAME_NOT_INITIALIZED:case MSI_INVALID_SESSION_ID:case E_MSI_USERMGR_USER_NOTFOUND:case E_MSI_CONNECT_FAILED:return true;}return false;}function isCSRFError(res){var c=(res&&res.getResponseHeader("X-MSTR-TaskErrorCode"))||"0";c=parseInt(c,10);if(c===CSRF_ERROR){return true;}return false;}function xhrSupportsProgress(xhr){return !mstrmojo.dom.isSafari&&!!(xhr&&xhr.upload&&xhr.upload.onprogress);}mstrmojo.SimpleXHR=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.SimpleXHR",isTask:true,async:true,init:function init(props){mstrmojo.hash.copy(props,this);},onreadystatechange:function onreadystatechange(xhr,callback,prevRequest){if(xhr.readyState!==4){return ;}if(typeof callback!=="object"){return ;}try{if((xhr.status===200)||(xhr.status===304)){this.response=callback.textResponse?xhr.responseText:evalResponse(xhr.responseText);if(typeof callback.success==="function"){callback.success(this.response,xhr);}}else{if(xhr.status!==0||(!xhr.isAborted&&prevRequest.params.displayNoResErr)){var app=mstrApp,sessionExp=app&&app.onSessionExpired;if(isCSRFError(xhr)&&mstrConfig&&mstrConfig.validateRandNum){var url=window.location.href;var pos=url.indexOf("?");if(pos>0){url=url.substring(0,pos);}url+="?pg=CSRFConfirmation";window.location.href=url;}if(sessionExp&&isSessionExpiredError(xhr)){sessionExp.call(app,prevRequest);}else{var orig=xhr.getResponseHeader;xhr.getResponseHeader=function(name){return decodeHeader(orig.apply?orig.apply(xhr,[name]):orig(name));};if(typeof callback.failure==="function"){callback.failure(xhr);}}}}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(typeof callback.complete==="function"){callback.complete();}if(!isSessionExpiredError(xhr)&&!prevRequest.params.notRestartSessionManager){var sm=mstrApp.sessionManager;if(sm&&sm.restart){sm.restart();}}}},cancel:function(){var didCancel=false;var xhr=this.xhr;if(xhr){delete xhr.onreadystatechange;xhr.isAborted=true;if(xhr.readyState<4){xhr.abort();didCancel=true;}this.xhr=null;}return didCancel;},request:function request(method,baseUrl,callback,params,webSvrUrl,useResFeed,webSrvParams){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("POST",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{var xhr=createXhr();xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(this,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=(function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback));}this.xhr=xhr;sendXhr.call(this,xhr,method,baseUrl,params);}}});mstrmojo.QueuedXHR=mstrmojo.declare(mstrmojo.SimpleXHR,null,{scriptClass:"mstrmojo.QueuedXHR",queue:null,requestCount:0,retryDelay:1,lookup:null,cancel:function cancel(){var didCancel=this._super();while(this.queue.length){var x=this.queue.pop();var cb=x.callback;if(cb&&cb.complete){cb.complete();}}this.queue=[];this.requestCount--;return didCancel;},init:function init(){this.queue=[];this.lookup=[];},request:function request(method,baseUrl,callback,params,override,webSvrUrl,useResFeed,webSrvParams,useCache){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("POST",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{if(this.requestCount>0&&!override){this.queue.push({method:method,baseUrl:baseUrl,callback:callback,params:params});}else{if(this.requestCount>0){this.cancel();}this.requestCount++;var lu=null,oriParams=null;if(useCache){lu=this._searchForCacheRequest(params);oriParams=mstrmojo.hash.copy(params);}if(lu){try{if(callback.success){window.setTimeout(function(){callback.success(lu.res);},10);}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(callback.complete){callback.complete();}this.advanceQueue();}}else{var xhr=this.xhr=createXhr();callback=mstrmojo.func.wrapMethods(callback,{complete:(function(ths){return function(){ths.advanceQueue();};}(this)),success:(function(ths){return function(){if(useCache){ths.lookup.push({params:oriParams,res:ths.response});}};}(this))});xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(this,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=(function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback));}sendXhr.call(this,xhr,method,baseUrl,params);}}}},upload:function upload(method,baseUrl,callback,params,data,config,override,webSrvParams,useCache){if(this.isTask){params=mstrmojo.addCSRFTokenToTaskParams(params);}if(this.requestCount>0&&!override){this.queue.push({method:method,baseUrl:baseUrl,callback:callback,params:params,data:data,config:config});}else{if(this.requestCount>0){this.cancel();}this.requestCount++;var lu=null,oriParams=null;if(useCache){lu=this._searchForCacheRequest(params);oriParams=mstrmojo.hash.copy(params);}if(lu){try{if(callback.success){window.setTimeout(function(){callback.success(lu.res);},10);}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(callback.complete){callback.complete();}this.advanceQueue();}}else{var xhr=this.xhr=createXhr();var self=this;callback=mstrmojo.func.wrapMethods(callback,{complete:(function(ths){return function(){ths.advanceQueue.call(ths);};}(this)),success:(function(ths){return function(){if(useCache){ths.lookup.push({params:oriParams,res:ths.response});}};}(this))});var handleProgress=function(event){callback.progress(event,config);};var url=baseUrl;var async=!!(config&&config.async);xhr.open("POST",url,async);var appReqHeaders=typeof (mstrConfig)!==undefined&&mstrConfig.requestHeaders;if(appReqHeaders){for(var key in appReqHeaders){xhr.setRequestHeader(key,appReqHeaders[key]);}}checkToAddRequestHeadersForXhr(xhr,params);if(config&&config.authToken){xhr.setRequestHeader("X-MSTR-AuthToken",config.authToken);if("projectId" in params){xhr.setRequestHeader("X-MSTR-ProjectId",params.projectId);}}var formData=new FormData();var a;for(a in params){formData.append(a,params[a]);}if(data){if(params.fileName){formData.append(params.fileFieldName?params.fileFieldName:"myFile",data,params.fileName);}else{formData.append(params.fileFieldName?params.fileFieldName:"myFile",data);}}if(xhrSupportsProgress(xhr)&&callback.progress){xhr.upload.onprogress=handleProgress;}xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(self,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));xhr.send(formData);}}},advanceQueue:function advanceQueue(){this.requestCount--;if(this.queue.length===0){this.requestCount=0;return ;}var req=this.queue.shift();if(req.params.taskId==="importFile"||req.params.taskId==="arch.sparkFileUpload"){this.upload(req.method,req.baseUrl,req.callback,req.params,req.data,req.config);}else{this.request(req.method,req.baseUrl,req.callback,req.params,true);}},_searchForCacheRequest:function _searchForCacheRequest(params){var i;for(i in this.lookup){if(mstrmojo.hash.equals(params,this.lookup[i].params)){return this.lookup[i];}}return null;},hasRequests:function hasRequests(){return this.requestCount>0||mstrmojo.jsonp.hasRequests();}});mstrmojo.xhr=new mstrmojo.QueuedXHR();mstrmojo.jsonp={jsc:new Date().getTime(),timeToWait:20000,requestCount:0,request:function(url,params,callback){var head=document.getElementsByTagName("head")[0]||document.documentElement,jsonp="jsonp"+(this.jsc++),script=document.createElement("script");params.jsonp=jsonp+"(@R@);";params.taskContentType="jsonp";params.taskEnv="jsonp";params.xts=new Date().getTime();window[jsonp]=function(response){mstrmojo.jsonp.requestCount--;if(!response){if(callback.timeout){callback.timeout();}}else{if(response.status===200){callback.success(response.content);}else{var res={status:response.status,getResponseHeader:function(name){switch(name){case"X-MSTR-TaskFailureMsg":return response.errorMsg;case"X-MSTR-TaskErrorCode":return response.errorCode;}}};if(mstrApp.onSessionExpired&&isSessionExpiredError(res)){if(callback.onSessionExpired){callback.onSessionExpired();}else{mstrApp.onSessionExpired();}}else{callback.failure(res);}}}if(window[jsonp]){if(callback.complete){callback.complete();}window[jsonp]=undefined;try{delete window[jsonp];}catch(e){}head.removeChild(script);}};head.insertBefore(script,head.firstChild);this.requestCount++;script.src=appendUrlParams("GET",url,params);setTimeout(function(){var fn=window[jsonp];if(fn){fn();}},this.timeToWait);},hasRequests:function(){return this.requestCount>0;}};}());